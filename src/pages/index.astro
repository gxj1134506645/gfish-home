---
import BaseLayout from "../layouts/BaseLayout.astro";
import Nav from "../components/Nav.astro";
import Footer from "../components/Footer.astro";
import SocialLinks from "../components/SocialLinks.astro";
import ProjectCard from "../components/ProjectCard.astro";
import siteData from "../data/site.json";
import projects from "../data/projects.json";
import { getCollection } from 'astro:content';
import PostList from "../components/PostList.astro";

const lang: 'zh' = 'zh';
const d = siteData[lang];
const posts = (await getCollection('blog', ({data}) => data.lang === 'zh' && !data.draft)).sort((a,b)=> b.data.date.localeCompare(a.data.date)).slice(0,5);
---
<BaseLayout lang={lang}>
  <Nav lang={lang} />
  <main class="max-w-5xl mx-auto px-4 py-10">
    <section class="mb-10">
      <h1 class="text-3xl font-bold">{d.siteName}</h1>
      <p class="text-gray-600 dark:text-gray-400 mt-2">{d.tagline}</p>
    </section>

    <section class="mb-12">
      <h2 class="text-xl font-semibold mb-4">项目</h2>
      <div class="grid sm:grid-cols-2 gap-4">
        {projects.map(p => <ProjectCard lang={lang} item={p} />)}
      </div>
    </section>

    <section class="mb-12">
      <h2 class="text-xl font-semibold mb-4">最新文章</h2>
      <PostList lang={lang} posts={posts} />
    </section>

    <section class="mb-12">
      <h2 class="text-xl font-semibold mb-4">媒体矩阵</h2>
      <SocialLinks lang={lang} />
    </section>
  </main>
  <Footer lang={lang} />
</BaseLayout>
